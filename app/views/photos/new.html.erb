<h1>写真投稿</h1>
<% if logged_in? %>
  <div class="row">
    <div class="col-sm-6 offset-sm-3">
      <%= form_with(model: @photo, local:true) do |f| %>
      <%= render 'layouts/error_messages', model: f.object %>

      <div class="form-group">
        <%=f.label "写真アップロード" %><br>
        <div class="upImage__preview">
          <%= image_tag @photo.image.url, id: :img_prev %>
          <%= f.file_field :image, class: 'form-controller', id: :up_img %>
          <%= f.hidden_field :image_cache %>
          <script type="text/javascript">
            $(function () {
              function readURL(input) {
                if (input.files && input.files[0]) {
                  var reader = new FileReader();
                  reader.onload = function (e) {
                    $('#img_prev').attr('src', e.target.result);
                  }
                  reader.readAsDataURL(input.files[0]);
                }
                #$('#img_prev').attr('src', '')
              }
              $("#up_img").change(function () {
                readURL(this);
              });
            });
          </script>
        </div>
    </div>

    <div class="form-group">
      <%= f.label :title, 'タイトル' %>
      <%= f.text_field :title, class: 'form-control' %>
    </div>
    <div class="form-group">
      <%= f.label :day, '撮影日' %>
      <%= f.date_field :day, class: 'form-control' %>
    </div>
    <div class="form-group">
      <%= f.label :equipment, '機材' %>
      <%= f.text_field :equipment, class: 'form-control' %>
    </div>
    <div class="form-group">
      <%= f.label :comment, 'コメント' %>
      <%= f.text_area :comment, class: 'form-control', row: 6 %>
    </div>
    <div class="form-group offset-5">
      <%= f.submit '投稿する' , class: 'btn btn-primary' %>
    </div>
  <% end %>
</div>
</div>
<% end %>
